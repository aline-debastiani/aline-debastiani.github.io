{"ast":null,"code":"import _slicedToArray from\"/home/alinedebastiani/sd-08-project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import{useDispatch,useSelector}from'react-redux';import Carousel from'react-multi-carousel';import{fetchRecipes,fetchRecommendations}from'../actions/recipes';import Loading from'../components/Loading';import RecipeCard from'../components/RecipeCard';import IngredientsList from'../components/IngredientsList';import ProgressButton from'../components/ProgressButton';import FavButton from'../components/FavButton';import ShareButton from'../components/ShareButton';import'bootstrap/dist/css/bootstrap.min.css';import'./RecipeDetails.css';import'react-multi-carousel/lib/styles.css';function RecipeDetails(_ref){var params=_ref.match.params,pathname=_ref.location.pathname;var _useSelector=useSelector(function(state){return state.recipes;}),list=_useSelector.list,isFetching=_useSelector.isFetching,recommendations=_useSelector.recommendations;var _useSelector2=useSelector(function(state){return state.login;}),mealsToken=_useSelector2.mealsToken,cocktailsToken=_useSelector2.cocktailsToken;var dispatch=useDispatch();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),shouldFetch=_useState2[0],setShouldFetch=_useState2[1];var inProgress=pathname.split('/')[3]==='in-progress';var type=useRef(pathname.split('/')[1]);var recommendationsType=useRef(type.current==='comidas'?'bebidas':'comidas');useEffect(function(){var token=pathname==='/comidas'?mealsToken:cocktailsToken;setShouldFetch(true);var _pathname$split$slice=pathname.split('/').slice(1);var _pathname$split$slice2=_slicedToArray(_pathname$split$slice,1);type.current=_pathname$split$slice2[0];recommendationsType.current=type.current==='comidas'?'bebidas':'comidas';dispatch(fetchRecipes(token,type.current,{request:'lookup',key:'i',parameter:params.id}));dispatch(fetchRecommendations(token,recommendationsType.current));setShouldFetch(false);},[params,pathname]);var recipe=list[0];var IngredientKeys=Object.keys(recipe||{}).filter(function(ingKey){return ingKey.startsWith('strIngredient')&&recipe[ingKey]!==''&&recipe[ingKey]!==null;});var IngredientsAndMeasures=IngredientKeys.map(function(key,index){return[recipe[key],recipe[\"strMeasure\".concat(index+1)]];});var responsive={tablet:{breakpoint:{max:1024,min:464},items:4},mobile:{breakpoint:{max:464,min:0},items:2}};return isFetching||shouldFetch||!recipe?/*#__PURE__*/React.createElement(Loading,null):/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(\"img\",{className:\"recipe-photo\",\"data-testid\":\"recipe-photo\",src:recipe.image,alt:recipe.name}),/*#__PURE__*/React.createElement(\"header\",{className:\"header-details\"},/*#__PURE__*/React.createElement(\"h1\",{\"data-testid\":\"recipe-title\"},recipe.name),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ShareButton,{type:type.current,id:params.id}),/*#__PURE__*/React.createElement(FavButton,{recipe:recipe}))),/*#__PURE__*/React.createElement(\"h2\",{className:\"header-title \",\"data-testid\":\"recipe-category\"},\"\".concat(recipe.alcoholicOrNot,\" \").concat(recipe.category)),/*#__PURE__*/React.createElement(\"section\",{className:\"section-recipe\"},/*#__PURE__*/React.createElement(IngredientsList,{id:params.id,type:type.current,ingredients:IngredientsAndMeasures})),/*#__PURE__*/React.createElement(\"section\",{className:\"section-recipe\"},/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"instructions\"},recipe.strInstructions)),recipe.strYoutube&&/*#__PURE__*/React.createElement(\"iframe\",{src:recipe.strYoutube.split('watch?v=').join('embed/'),title:\"Video\",\"data-testid\":\"video\"}),!inProgress&&/*#__PURE__*/React.createElement(Carousel,{className:\"carousel\",responsive:responsive},recommendations.map(function(recommendation,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"cards-recommendations\",\"data-testid\":\"\".concat(index,\"-recomendation-card\"),key:\"rec-\".concat(index)},/*#__PURE__*/React.createElement(RecipeCard,{index:index,recipe:recommendation,recommendation:true,type:recommendationsType.current}));})),/*#__PURE__*/React.createElement(ProgressButton,{id:params.id,type:type.current,ingredientsLength:IngredientsAndMeasures.length}));}export default RecipeDetails;","map":{"version":3,"sources":["/home/alinedebastiani/sd-08-project-recipes-app/src/pages/RecipeDetails.jsx"],"names":["React","useEffect","useRef","useState","useDispatch","useSelector","Carousel","fetchRecipes","fetchRecommendations","Loading","RecipeCard","IngredientsList","ProgressButton","FavButton","ShareButton","RecipeDetails","params","match","pathname","location","state","recipes","list","isFetching","recommendations","login","mealsToken","cocktailsToken","dispatch","shouldFetch","setShouldFetch","inProgress","split","type","recommendationsType","current","token","slice","request","key","parameter","id","recipe","IngredientKeys","Object","keys","filter","ingKey","startsWith","IngredientsAndMeasures","map","index","responsive","tablet","breakpoint","max","min","items","mobile","image","name","alcoholicOrNot","category","strInstructions","strYoutube","join","recommendation","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Carousel from 'react-multi-carousel';\nimport { fetchRecipes, fetchRecommendations } from '../actions/recipes';\nimport Loading from '../components/Loading';\nimport RecipeCard from '../components/RecipeCard';\nimport IngredientsList from '../components/IngredientsList';\nimport ProgressButton from '../components/ProgressButton';\nimport FavButton from '../components/FavButton';\nimport ShareButton from '../components/ShareButton';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './RecipeDetails.css';\nimport 'react-multi-carousel/lib/styles.css';\n\nfunction RecipeDetails({ match: { params }, location: { pathname } }) {\n  const { list, isFetching, recommendations } = useSelector((state) => state.recipes);\n  const { mealsToken, cocktailsToken } = useSelector((state) => state.login);\n  const dispatch = useDispatch();\n  const [shouldFetch, setShouldFetch] = useState(true);\n  const inProgress = pathname.split('/')[3] === 'in-progress';\n  const type = useRef(pathname.split('/')[1]);\n  const recommendationsType = useRef(type.current === 'comidas' ? 'bebidas' : 'comidas');\n\n  useEffect(() => {\n    const token = pathname === '/comidas' ? mealsToken : cocktailsToken;\n    setShouldFetch(true);\n    [type.current] = pathname.split('/').slice(1);\n    recommendationsType.current = type.current === 'comidas' ? 'bebidas' : 'comidas';\n    dispatch(fetchRecipes(token, type.current,\n      { request: 'lookup', key: 'i', parameter: params.id }));\n    dispatch(fetchRecommendations(token, recommendationsType.current));\n    setShouldFetch(false);\n  }, [params, pathname]);\n\n  const recipe = list[0];\n  const IngredientKeys = Object.keys(recipe || {})\n    .filter((ingKey) => (\n      ingKey\n        .startsWith('strIngredient')\n        && recipe[ingKey] !== '' && recipe[ingKey] !== null));\n  const IngredientsAndMeasures = IngredientKeys\n    .map((key, index) => [recipe[key], recipe[`strMeasure${index + 1}`]]);\n\n  const responsive = {\n    tablet: {\n      breakpoint: { max: 1024, min: 464 },\n      items: 4,\n    },\n    mobile: {\n      breakpoint: { max: 464, min: 0 },\n      items: 2,\n    },\n  };\n\n  return (\n    isFetching || shouldFetch || !recipe ? <Loading /> : (\n      <section>\n        <img\n          className=\"recipe-photo\"\n          data-testid=\"recipe-photo\"\n          src={ recipe.image }\n          alt={ recipe.name }\n        />\n        <header className=\"header-details\">\n          <h1 data-testid=\"recipe-title\">{ recipe.name }</h1>\n          <div>\n            <ShareButton type={ type.current } id={ params.id } />\n            <FavButton recipe={ recipe } />\n          </div>\n        </header>\n        <h2 className=\"header-title \" data-testid=\"recipe-category\">\n          { `${recipe.alcoholicOrNot} ${recipe.category}` }\n        </h2>\n        <section className=\"section-recipe\">\n          <IngredientsList\n            id={ params.id }\n            type={ type.current }\n            ingredients={ IngredientsAndMeasures }\n          />\n        </section>\n        <section className=\"section-recipe\">\n          <p data-testid=\"instructions\">{ recipe.strInstructions }</p>\n        </section>\n        { recipe.strYoutube\n        && <iframe\n          src={ recipe.strYoutube.split('watch?v=').join('embed/') }\n          title=\"Video\"\n          data-testid=\"video\"\n        /> }\n        { !inProgress && (\n          <Carousel className=\"carousel\" responsive={ responsive }>\n            { recommendations.map((recommendation, index) => (\n              <div\n                className=\"cards-recommendations\"\n                data-testid={ `${index}-recomendation-card` }\n                key={ `rec-${index}` }\n              >\n                <RecipeCard\n                  index={ index }\n                  recipe={ recommendation }\n                  recommendation\n                  type={ recommendationsType.current }\n                />\n              </div>\n            )) }\n          </Carousel>\n        )}\n        <ProgressButton\n          id={ params.id }\n          type={ type.current }\n          ingredientsLength={ IngredientsAndMeasures.length }\n        />\n      </section>\n    ));\n}\n\nRecipeDetails.propTypes = {\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      id: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  location: PropTypes.shape({\n    pathname: PropTypes.string.isRequired,\n  }).isRequired,\n};\n\nexport default RecipeDetails;\n"]},"metadata":{},"sourceType":"module"}