{"ast":null,"code":"import _defineProperty from\"/home/alinedebastiani/sd-08-project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useEffect,useRef}from'react';import{useDispatch,useSelector}from'react-redux';import{useHistory,useLocation}from'react-router';import{Button}from'react-bootstrap';import{startRecipe,endRecipe}from'../actions/recipes';import'./ProgressButton.css';function ProgressButton(_ref){var type=_ref.type,id=_ref.id,ingredientsLength=_ref.ingredientsLength;var _useLocation=useLocation(),pathname=_useLocation.pathname;var history=useHistory();var inProgress=pathname.split('/')[3]==='in-progress';var _useSelector=useSelector(function(state){return state.recipes;}),done=_useSelector.done,start=_useSelector.start,list=_useSelector.list;var refDone=useRef(done);var dispatch=useDispatch();var handleClick=function handleClick(){if(inProgress){dispatch(endRecipe(list[0]));return;}if(!Object.keys(start[type]).includes(id)){dispatch(startRecipe(type,_defineProperty({},id,[])));}history.push(\"\".concat(pathname,\"/in-progress\"));};useEffect(function(){if(refDone.current.length!==done.length){localStorage.setItem('doneRecipes',JSON.stringify(done));history.push('/receitas-feitas');}},[done]);var buttonName=function buttonName(){if(inProgress)return'Finalizar Receita';if(Object.keys(start[type]).includes(id))return'Continuar Receita';return'Iniciar Receita';};return done.some(function(_ref2){var currId=_ref2.id,currType=_ref2.type;return id===currId&&type.startsWith(currType);})||/*#__PURE__*/React.createElement(Button,{className:\"start\",\"data-testid\":inProgress?'finish-recipe-btn':'start-recipe-btn',type:\"button\",onClick:handleClick,disabled:inProgress&&(start[type][id]||[]).length!==ingredientsLength,block:true},buttonName());}export default ProgressButton;","map":{"version":3,"sources":["/home/alinedebastiani/sd-08-project-recipes-app/src/components/ProgressButton.jsx"],"names":["React","useEffect","useRef","useDispatch","useSelector","useHistory","useLocation","Button","startRecipe","endRecipe","ProgressButton","type","id","ingredientsLength","pathname","history","inProgress","split","state","recipes","done","start","list","refDone","dispatch","handleClick","Object","keys","includes","push","current","length","localStorage","setItem","JSON","stringify","buttonName","some","currId","currType","startsWith"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router';\nimport { Button } from 'react-bootstrap';\nimport { startRecipe, endRecipe } from '../actions/recipes';\nimport './ProgressButton.css';\n\nfunction ProgressButton({ type, id, ingredientsLength }) {\n  const { pathname } = useLocation();\n  const history = useHistory();\n  const inProgress = pathname.split('/')[3] === 'in-progress';\n  const { done, start, list } = useSelector((state) => state.recipes);\n  const refDone = useRef(done);\n  const dispatch = useDispatch();\n\n  const handleClick = () => {\n    if (inProgress) {\n      dispatch(endRecipe(list[0]));\n      return;\n    }\n    if (!Object.keys(start[type]).includes(id)) {\n      dispatch(startRecipe(type, { [id]: [] }));\n    }\n    history.push(`${pathname}/in-progress`);\n  };\n\n  useEffect(() => {\n    if (refDone.current.length !== done.length) {\n      localStorage.setItem('doneRecipes', JSON.stringify(done));\n      history.push('/receitas-feitas');\n    }\n  }, [done]);\n\n  const buttonName = () => {\n    if (inProgress) return 'Finalizar Receita';\n    if (Object.keys(start[type]).includes(id)) return 'Continuar Receita';\n    return 'Iniciar Receita';\n  };\n\n  return (\n    done.some(\n      ({ id: currId, type: currType }) => id === currId && type.startsWith(currType),\n    )\n          || (\n            <Button\n              className=\"start\"\n              data-testid={ inProgress ? 'finish-recipe-btn' : 'start-recipe-btn' }\n              type=\"button\"\n              onClick={ handleClick }\n              disabled={ inProgress\n               && (start[type][id] || []).length !== ingredientsLength }\n              block\n            >\n              { buttonName() }\n            </Button>\n          )\n  );\n}\n\nProgressButton.propTypes = {\n  type: PropTypes.string.isRequired,\n  id: PropTypes.string.isRequired,\n  ingredientsLength: PropTypes.number.isRequired,\n};\n\nexport default ProgressButton;\n"]},"metadata":{},"sourceType":"module"}